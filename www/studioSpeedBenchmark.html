<html>

<head>

  <!-- BoxItNow CSS -->
  <link rel="stylesheet" type="text/css" href="http://binalpha.boxitnow.com/css/bin.cache.min.css" />
  <!--<link rel="stylesheet" type="text/css" href="https://staging-fantastapack.boxitnow.com/css/bin.cache.min.css" /> -->

  <!-- BoxItNow JS -->
 <script type="text/javascript" src="http://binalpha.boxitnow.com/js/bin.bootstrap.js"></script>
<!--  <script type="text/javascript" src="https://staging-fantastapack.boxitnow.com/js/bin.bootstrap.js"></script> -->

  <!-- CLIENT CSS -->
  <!--<link rel="stylesheet" type="text/css" href="spectrum.css" />-->



  <style>
  	body {
    	margin: 0;
    	font-family: arial;
	}

	#header {
	    width: 100%;
	    text-align: center;
	    line-height: 150px;
	    height: 150px;
	    font-size: 30px;
	    border: 1px solid #444;
	    box-sizing: border-box;
	}

	#body {
	    min-height: 800px;
	    border: 0px solid #444;
	    position: relative;
	    box-sizing: border-box;
	}

	#tab {
	    position: absolute;
	    left: 0;
	    width: 20%;
	    top: 0;
	    bottom: 0;
	    border: 1px solid #444;
	    text-align: center;
	    line-height: 150px;
	    font-size: 30px;
	    box-sizing: border-box;
	}

	#studio, #viewer {
	    position: absolute;
	    right: 0;
	    width: 80%;
	    top: 0;
	    bottom: 0;
	    border: 1px solid #444;
	    box-sizing: border-box;
	    overflow: hidden;
	}

	#footer {
	    width: 100%;
	    text-align: center;
	    line-height: 150px;
	    height: 150px;
	    font-size: 30px;
	    border: 1px solid #444;
	    box-sizing: border-box;
	}


  .bin-widget div#graphics.section .accordion input:checked~.article.ac-colorSettings.tallWindow{

    height:200px;

  }


</style>

  <!-- CLIENT JS -->

  <!-- You can pre load the following, BIN will load if they are not already loaded -->
  <script type="text/javascript" src="//code.jquery.com/jquery-2.1.3.js"></script>
  <!--<script type="text/javascript" src="//code.jquery.com/ui/1.11.0/jquery-ui.js"></script>-->
  <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r72/three.js"></script>-->
  <!--<script type="text/javascript" src="spectrum.js"></script>-->

  <!-- EXAMPLE USER INTEGRATION SCRIPT -->
  <script>



//TODO: 1
//this is always blank?

  </script>


  <!-- EXAMPLE LOAD/CREATE SCRIPT -->
  <script>

  var baseTime = Date.now();

  function decode(s) {
    return decodeURIComponent(s.split("+").join(" "));
  }

  var urlVars = {};
  document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g, function () {

    urlVars[decode(arguments[1])] = decode(arguments[2]);

    console.log(urlVars);

  });



  var newId = urlVars['id'] ? urlVars['id'] : 79;

  var newType = urlVars['type'] ? urlVars['type'] : 'standard';

  var newToken = urlVars['token'] ? urlVars['token'] :'782d598a08047bdae505e9c3ef7412fa';//'85dd039547e5c36f6aa255a4d843407a';// '19fa361de429a55934a330d84bdb6179'; //'57d1d184a852ab627b8cf587367e514d';//

  var startTime = Date.now();

    //LOAD bin libraries
    BIN.Bootstrap.load({
      //the root of the BIN HOST site
      apiUrl: "http://binalpha.boxitnow.com/",
      apiKey: "VGL6TmfXuFMprVPy"

    }, function() {

      var loadBINTime = Date.now();

      var loaded = false;

      var tabCount = 0;
      var tabsReadyAll = false;
      var myGraphicsIOSwitch = false;

      var myGraphicsUploadTime;
      var myGraphicsDownloadTime;

      var myGraphicsDownloadFinished = false;
      var standardGraphicsDownloadFinished = false;



      $('#onBINBoardTime').val(loadBINTime - baseTime);

      //Begin create studio
      BIN.Widgets.Create({
        //can be: 'viewer' (3d viewer), 'studio' (3d design studio) , 'boxes' (My Boxes), 'media' (Media Manager)
        type: 'studio',
        //(require) Html div to attach the widget to
        tag: $('#studio'),
        //(optional) required if loading user design, user media or user projects
        userToken: newToken,
        //(require for design studio)design information to load
        design: {
          //(require) 'standard' or 'user'
          type: newType,
          //(require) id of item or resize
          id: newId,
          //(optional)


          //TODO: 2
          //How to show number of options here?
          //Full list, more options, example params?
        //  parameters: {
          // Length: "15.1",
        /*    Bottleheight: "10.1",
            Bottleh: "11.1",
            BOTTLEHEIGHT: "14.3",
            BOTTLEH: "16.2",
            Front: "12",
            FRONT: "12.5",
            Width: "13",*/
          //  Finish: "Kraft",
        //    Allowance: ".163"
      //    }
          //Probalby more than Length, Width, Depth, depending on design.
          //Null value? (not included)
          //default values? (for params that are not included)
        },

        //(optional) for loading for design studio
        options: {
              user: {
                saving: 'simple'
                //TODO: 3
                //'simple' saving does not require a folder selection
                //what is the other type?
                //null value? (not included)
                //default value (invalid, incorrect param)
              },
              defaultLayout: {
                showScores: false
                //TODO: 4a
                //more?
              },
              ui: {
                // corresponds to resizer, export, graphics views
                initialTab: 'measurements', //{'measurements', 'graphics', 'export'}
                saveButtonText: 'SAVE DESIGN',
                saveProgressText: 'Saving...',
                saveFinishText: 'DESIGN SAVED'
                //TODO: 4b
                //default and null values?
              },
              resizer: {
                //TODO: 5
                enabled: true,
                readonly: false,
                modules: [], //options here?
                trimParams: true //not sure what this does
              },

              export: {
                //TODO: 6
                enabled: true,
                modules: ['mod_share, mod_ftp'] //other options? printos?
                //ftp is disabled in general?
                //these are also (possibly only) controlled in the admin site settings
              },
              graphics: {
                //TODO: 7
                enabled: true,
                useKraft: false, //not sure what this does
                modules: ['mod_standard', 'mod_graphics', 'mod_text', 'mod_color', 'mod_panel', 'mod_pattern']
                //null value (not included): all enabled
                //default value ([]): all disabled
                //specified value (['x', 'y']) : x, y enabled; z disabled;
              },
              views: {
                //TODO: 8
                '3d': '3D',
                'outside': 'Outside View',
                'inside': 'Inside View',
                'cad': null,
                'details': null,
                'fullscreen': null,
                '2nd_view': null
                //null value (not included) : enabled, default title
                //default value (null) : disabled
                //specified value ('X View') : enabled, title 'X View'
              },

              tabs: {
                resizer : 'Default Dimensions',
                graphics : 'Default Graphics',
                export : 'Default <br /> Share',
              },

              //TODO: 9
              //not entirely sure what form refers to generally
              form: {
                fields: {

                },
                hideAdvancedDims: true
              },
              finishes: {
                //TODO: 9
                enable: true,
                label: 'Materials', //label default/null values?
                options: {
                  'Standard White': { //mapping?? 'Standard White' is what value/title/name
                    renderBase: 'color',  //renderbase default/null values?
                    interior: 'white'  //interior default/null values?
                    //null renderSurface : default/null values?
                  },
                  'Premium White': {
                    renderBase: 'color',
                    interior: 'white'
                  },
                  'Premium White with Gloss Ink Finish': {
                    renderBase: 'color',
                    renderSurface: 'gloss',
                    interior: 'white'
                  },
                  'Kraft': {
                    // double sided kraft //TODO:10 Why does this make it double sided kraft?
                    renderBase: 'kraft'
                  }
                }
              },
              //TODO: 11
              //Finishes/Materials naming convention...
              //The only reason I can keep this straight is because I think of them as the two different dropdowns
              //but they should follow a more divisive naming convention

              //default/null value?
              materials: {
                enable: true
              }
            },


          //TODO: 12
          //Function event fires before or after action ( on success/error)?
          //e.g. buttonClick onSave or function return onSave?
    		onSave : function(userSessionHandle, parameters) {

          var saveTime = Date.now();

          $('#onSaveBoardTime').val(saveTime - baseTime);
          console.log("onSave return...."+saveTime);

          //$('#exportBoardBtn').click();


    		},

        //(optional)after studio is loaded
        onLoad: function(userSessionHandle) { //TODO: 13 not sure what userSessionHandle is supposed to have


          var loadTime = Date.now();

          loaded = true;

          $('#onLoadBoardTime').val(loadTime - baseTime);


        /*  if(myGraphicsDownloadFinished && standardGraphicsDownloadFinished && loaded && tabsReadyAll){
            $('#resizeBtn').click();
          }*/


        },

        //(optional)user does a resize
        //TODO: 14
        //Function event fires before or after action ( on success/error)?
        onResize: function(userSessionHandle, parameters) {

          var resizeTime = Date.now();

          $('#onResizeBoardTime').val(resizeTime - baseTime);

          console.log(parameters);

          $('.save_button').click();

          $('#exportBoardBtn').click();
        },

        //(required)
        //TODO: 15
        //onExport says 'required', but is not implemented anywhere (and doesn't seem to have a problem with that)
        //Are there any parameters for this function call?
        //Function event fires before or after action ( on success/error)?
        //
        /*
        onExport: function() {},
        */


        onTabsReady : function() {

          var tabTime = Date.now();

          console.log("-----Tab Time = " + (tabTime - baseTime));

          tabCount++;
          $('#onTab'+tabCount+'BoardTime').val(tabTime - baseTime);


    		},

        onTabsReadyAll : function() {


          var tabAllTime = Date.now();

          tabsReadyAll = true;

          $('#onTabAllBoardTime').val(tabAllTime - baseTime);



          if(document.getElementById('useInsideGraphics').value == 1){
              var x = $('.article.ac-colorSettings');
               $(x).addClass("tallWindow");
             }


          $('#resizeBtn').on('click', function(){

            //if(!resizeButtonTimerSwitch){

                 baseTime = Date.now();
                 console.log("New Basetime (Resize) = " + baseTime);
              //}

          });

          $('.save_button').on('mouseup', function(event){

              baseTime = Date.now();
              console.log("New Basetime (Save) = " + baseTime);


          });

          $('.add-photo-btn').on('click', function(){

            //  baseTime = Date.now();
            //  console.log("New Basetime (Upload - My Graphics) = " + baseTime);

              myGraphicsIOSwitch = true;

              window.addEventListener('focus', window_focus, false);
                function window_focus(){
                    window.removeEventListener('focus', window_focus, false);
                    //console.log("THE WINDOW EVENT LSITENR FIRED!!!!");

                    baseTime = Date.now();
                    console.log("New Basetime (Upload - My Graphics) = " + baseTime);

                    //$('#onUploadBoardTime').val(downloadPDFTime - baseTime);
                    //URL.revokeObjectURL(url);
                    //console.log('revoke ' + url);
                }

          });

          $('.downloadFileLink').on('click', function(){

              baseTime = Date.now();
              console.log("New Basetime (Download - Files) = " + baseTime);

              window.addEventListener('focus', window_focus, false);
                function window_focus(){
                    window.removeEventListener('focus', window_focus, false);

                    downloadPDFTime = Date.now();

                    $('#onUploadBoardTime').val(downloadPDFTime - baseTime);
                    //URL.revokeObjectURL(url);
                    //console.log('revoke ' + url);
                }

          });


          $("body").on('DOMSubtreeModified', "#myGraphics", function() {

            if(myGraphicsIOSwitch){
               myGraphicsUploadTime = Date.now();
               $('#onUploadBoardTime').val(myGraphicsUploadTime - baseTime);
             }
            else{
              myGraphicsDownloadTime = Date.now();
              $('#onDownloadMyGraphicsBoardTime').val(myGraphicsDownloadTime - baseTime);
              myGraphicsDownloadFinished = true;

              console.log("TRUTH TABLE VALUES MG+==" + myGraphicsDownloadFinished + " " + standardGraphicsDownloadFinished + " " + loaded + " " + tabsReadyAll);

              /*if(myGraphicsDownloadFinished && standardGraphicsDownloadFinished && loaded && tabsReadyAll){
                console.log("CLICKED MYGRAPHS RESIZE");
                $('#resizeBtn').click();
              //  setTimeout(function(){$('#resizeBtn').click(); }, 2000);
            }*/
            }

          });

          $("body").on('DOMSubtreeModified', "#standardGraphics", function() {


              var standardGraphicsDownloadTime = Date.now();
              $('#onDownloadStandardGraphicsBoardTime').val(standardGraphicsDownloadTime - baseTime);
              standardGraphicsDownloadFinished = true;

              console.log("TRUTH TABLE VALUES Standard +==" + myGraphicsDownloadFinished + " " + standardGraphicsDownloadFinished + " " + loaded + " " + tabsReadyAll);

            /*  if(myGraphicsDownloadFinished && standardGraphicsDownloadFinished && loaded && tabsReadyAll){
                console.log("CLICKED SG RESIZE");
                $('#resizeBtn').click();
                //setTimeout(function(){$('#resizeBtn').click(); }, 2000);
              }*/
          });




        //  $('#resizeBtn').click();
        /*  if(myGraphicsDownloadFinished && standardGraphicsDownloadFinished && loaded && tabsReadyAll){
            $('#resizeBtn').click();
          }*/


    		},



      });
    });
  </script>
  <title>Page</title>
</head>

<body>
  <!-- BEGIN PAGE -->
  <div id='header'>

    <div id="nav" data-include="nav"></div>

  </div>


  <div id='body'>

    <div id="board" data-include="board"></div>

    <div id='studio'></div>

  </div>

  <div id='footer'>
    footer
  </div>
  <!-- END PAGE -->



  <script type='text/javascript' src="js/dataSpeedInclude.js" ></script>

  <script>

  $('#resizeBtn').on('click', function(){

      baseTime = Date.now();
      console.log("New Basetime = " + baseTime);

  });

  </script>
</body>

</html>
